<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Custom Menu</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;500;600&display=swap');
        
        :root {
            --primary-color: #3b82f6;
            --primary-dark: #2563eb;
            --primary-darker: #1e40af;
            --primary-light: rgba(59, 130, 246, 0.8);
            --primary-glow: rgba(59, 130, 246, 0.4);
            --theme-name: 'Blue';
        }

        .theme-red {
            --primary-color: #ef4444;
            --primary-dark: #dc2626;
            --primary-darker: #b91c1c;
            --primary-light: rgba(239, 68, 68, 0.8);
            --primary-glow: rgba(239, 68, 68, 0.4);
            --theme-name: 'Red';
        }

        .theme-green {
            --primary-color: #10b981;
            --primary-dark: #059669;
            --primary-darker: #047857;
            --primary-light: rgba(16, 185, 129, 0.8);
            --primary-glow: rgba(16, 185, 129, 0.4);
            --theme-name: 'Green';
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #0a0a0a;
            color: #ffffff;
            overflow: hidden;
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: flex-start;
            padding: 50px;
            gap: 8px;
        }

        .custom-banner {
            width: 300px;
            height: 80px;
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 50%, var(--primary-darker) 100%);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 15px var(--primary-glow);
        }

        .banner-text {
            font-size: 24px;
            font-weight: 600;
            color: white;
            text-align: center;
        }

        .main-layout {
            display: flex;
            gap: 15px;
            align-items: flex-start;
        }

        .menu-layout {
            position: relative;
            width: 300px;
        }

        .player-info-panel {
            width: 200px;
            background: rgba(30, 30, 30, 0.85);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            padding: 12px;
            display: none;
        }

        .player-info-panel.visible {
            display: block;
        }

        .player-info-header {
            font-size: 14px;
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 8px;
            text-align: center;
        }

        .player-info-item {
            display: flex;
            justify-content: space-between;
            font-size: 11px;
            margin-bottom: 4px;
            padding: 2px 0;
        }

        .player-info-label {
            color: #9ca3af;
        }

        .player-info-value {
            color: #ffffff;
            font-weight: 500;
        }

        .player-info-value.online {
            color: #10b981;
        }

        .player-info-value.offline {
            color: #ef4444;
        }

        .scrollbar-container {
            width: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            position: absolute;
            left: -12px;
            top: 0;
            z-index: 10;
            opacity: 1;
            visibility: visible;
            transition: all 0.3s ease;
        }

        .menu-container {
            width: 300px;
            background: transparent;
            border: none;
            border-radius: 6px;
            overflow: hidden;
            position: relative;
        }

        .search-container {
            width: 300px;
            background: rgba(30, 30, 30, 0.85);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            padding: 12px;
            display: none;
            margin-bottom: 8px;
        }

        .search-container.visible {
            display: block;
        }

        .search-input {
            width: 100%;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 4px;
            padding: 8px 12px;
            color: white;
            font-size: 13px;
            outline: none;
        }

        .search-input:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 8px var(--primary-glow);
        }

        .search-results {
            max-height: 200px;
            overflow-y: auto;
            margin-top: 8px;
        }

        .search-result-item {
            padding: 6px 8px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 3px;
            margin-bottom: 2px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.2s ease;
        }

        .search-result-item:hover {
            background: var(--primary-light);
        }

        .search-result-path {
            color: #9ca3af;
            font-size: 10px;
        }

        .theme-selector-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
        }

        .theme-selector-modal.visible {
            display: flex;
        }

        .theme-selector-content {
            background: rgba(30, 30, 30, 0.95);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 24px;
            width: 300px;
        }

        .theme-selector-title {
            font-size: 18px;
            font-weight: 600;
            color: white;
            text-align: center;
            margin-bottom: 20px;
        }

        .theme-options {
            display: flex;
            gap: 16px;
            justify-content: center;
            margin-bottom: 20px;
        }

        .theme-option {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            padding: 12px;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .theme-option:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .theme-option.active {
            background: var(--primary-light);
        }

        .theme-circle {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .theme-option.active .theme-circle {
            border-color: white;
            transform: scale(1.1);
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.4);
        }

        .theme-circle.blue {
            background: linear-gradient(135deg, #3b82f6, #2563eb);
        }

        .theme-circle.red {
            background: linear-gradient(135deg, #ef4444, #dc2626);
        }

        .theme-circle.green {
            background: linear-gradient(135deg, #10b981, #059669);
        }

        .theme-name {
            font-size: 12px;
            color: #9ca3af;
            font-weight: 500;
        }

        .theme-option.active .theme-name {
            color: white;
        }

        .theme-close-button {
            width: 100%;
            background: var(--primary-color);
            border: none;
            border-radius: 6px;
            color: white;
            padding: 10px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .theme-close-button:hover {
            background: var(--primary-dark);
        }

        .menu-section {
            display: none;
        }

        .menu-body {
            background: transparent;
            overflow: hidden;
            position: relative;
            min-height: 280px;
        }

        .menu-items {
            transition: transform 0.15s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .menu-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 8px 16px;
            background: transparent;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            cursor: pointer;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            height: 35px;
            position: relative;
            margin-bottom: 2px;
            border-radius: 4px;
        }

        .menu-item:hover:not(.selected) {
            background: rgba(255, 255, 255, 0.05);
            border-color: rgba(255, 255, 255, 0.2);
        }

        .menu-item.selected {
            background: var(--primary-light);
            border-color: var(--primary-color);
            color: white;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .menu-item.selected::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, var(--primary-glow), transparent 50%);
            pointer-events: none;
        }

        .menu-item-text {
            font-size: 13px;
            font-weight: 400;
            color: inherit;
        }

        .menu-item-arrow {
            color: #9ca3af;
            font-size: 14px;
            font-weight: bold;
            text-shadow: 0 0 2px rgba(0, 0, 0, 0.5);
            -webkit-text-stroke: 0.5px rgba(255, 255, 255, 0.4);
            text-stroke: 0.5px rgba(255, 255, 255, 0.4);
        }

        .menu-item.selected .menu-item-arrow {
            color: white;
            -webkit-text-stroke: 0.5px rgba(255, 255, 255, 0.8);
            text-stroke: 0.5px rgba(255, 255, 255, 0.8);
        }

        .menu-item.toggle {
            justify-content: space-between;
        }

        .toggle-switch {
            width: 32px;
            height: 18px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 9px;
            position: relative;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .toggle-switch.active {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            border-color: var(--primary-color);
            box-shadow: 0 0 8px var(--primary-glow);
        }

        .toggle-switch::after {
            content: '';
            position: absolute;
            top: 1px;
            left: 1px;
            width: 14px;
            height: 14px;
            background: white;
            border-radius: 50%;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .toggle-switch.active::after {
            transform: translateX(14px);
            background: #f8fafc;
        }

        .toggle-switch:hover {
            transform: scale(1.05);
        }

        .toggle-switch:active {
            transform: scale(0.95);
        }

        .scrollbar-thumb {
            width: 6px;
            background: linear-gradient(180deg, var(--primary-color), var(--primary-dark));
            border-radius: 3px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: absolute;
            top: 0;
            box-shadow: 0 2px 8px var(--primary-glow);
        }

        .scrollbar-thumb:hover {
            background: var(--primary-color);
        }

        .menu-footer {
            background: rgba(22, 22, 22, 0.9);
            backdrop-filter: blur(10px);
            padding: 8px 16px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            width: 300px;
            margin-top: 5px;
            position: relative;
            transition: all 0.3s ease;
        }

        .menu-build {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 10px;
            color: #9ca3af;
            font-weight: 400;
        }

        .menu-page {
            font-size: 10px;
            color: #9ca3af;
            font-weight: 400;
        }

        .back-button {
            position: absolute;
            top: 8px;
            left: 8px;
            width: 24px;
            height: 24px;
            background: var(--primary-light);
            border: none;
            border-radius: 4px;
            color: white;
            cursor: pointer;
            display: none;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            transition: all 0.2s ease;
        }

        .back-button:hover {
            background: var(--primary-color);
            transform: scale(1.1);
        }

        .back-button.visible {
            display: flex;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.95) 0%, rgba(20, 20, 20, 0.9) 100%);
            backdrop-filter: blur(15px);
            color: white;
            padding: 16px 24px;
            border-radius: 12px;
            border: 1px solid var(--primary-color);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4), 0 0 20px var(--primary-glow);
            transform: translateX(120%);
            opacity: 0;
            transition: all 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            z-index: 1000;
            font-size: 14px;
            font-weight: 500;
            min-width: 200px;
            text-align: center;
        }

        .notification::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: 12px;
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%);
            opacity: 0.1;
            z-index: -1;
        }

        .notification.show {
            transform: translateX(0);
            opacity: 1;
        }

        .notification.hide {
            transform: translateX(120%);
            opacity: 0;
        }
    </style>
</head>
<body>
    <div class="custom-banner">
        <div class="banner-text">Custom Banner</div>
    </div>

    <div class="search-container" id="searchContainer">
        <input type="text" class="search-input" id="searchInput" placeholder="Search features..." autocomplete="off">
        <div class="search-results" id="searchResults"></div>
    </div>

    <div class="main-layout">
        <div class="menu-layout">
            <div class="scrollbar-container">
                <div class="scrollbar-thumb" id="scrollThumb"></div>
            </div>

            <div class="menu-container">
                <button class="back-button" id="backButton" onclick="goBack()">‚Üê</button>
                <div class="menu-section">Main menu</div>
                
                <div class="menu-body">
                    <div class="menu-items" id="menuItems">
                        <!-- Main menu items will be populated by JavaScript -->
                    </div>
                </div>
            </div>
        </div>

        <div class="player-info-panel" id="playerInfoPanel">
            <div class="player-info-header" id="playerInfoName">CRQOLQVRQO</div>
            <div class="player-info-item">
                <span class="player-info-label">Distance</span>
                <span class="player-info-value" id="playerDistance">126.0m</span>
            </div>
            <div class="player-info-item">
                <span class="player-info-label">Server ID</span>
                <span class="player-info-value" id="playerServerId">302902</span>
            </div>
            <div class="player-info-item">
                <span class="player-info-label">Health</span>
                <span class="player-info-value" id="playerHealth">200 ü©∏</span>
            </div>
            <div class="player-info-item">
                <span class="player-info-label">Armor</span>
                <span class="player-info-value" id="playerArmor">0</span>
            </div>
            <div class="player-info-item">
                <span class="player-info-label">Weapon</span>
                <span class="player-info-value" id="playerWeapon">Unarmed</span>
            </div>
            <div class="player-info-item">
                <span class="player-info-label">Vehicle</span>
                <span class="player-info-value" id="playerVehicle">Outside</span>
            </div>
            <div class="player-info-item">
                <span class="player-info-label">Alive</span>
                <span class="player-info-value online" id="playerAlive">Alive</span>
            </div>
            <div class="player-info-item">
                <span class="player-info-label">Speed</span>
                <span class="player-info-value" id="playerSpeed">0km/h</span>
            </div>
            <div class="player-info-item">
                <span class="player-info-label">Friend</span>
                <span class="player-info-value" id="playerFriend">No</span>
            </div>
        </div>
    </div>

    <div class="menu-footer">
        <div class="menu-build">
            <span>Insanity.lua</span>
            <span>Build: 262119</span>
        </div>
        <div class="menu-page" id="pageIndicator">1 / 9</div>
    </div>

    <!-- Theme Selector Modal -->
    <div class="theme-selector-modal" id="themeModal">
        <div class="theme-selector-content">
            <div class="theme-selector-title">Choose Theme Color</div>
            <div class="theme-options">
                <div class="theme-option active" id="themeBlue" onclick="selectTheme('blue')">
                    <div class="theme-circle blue"></div>
                    <div class="theme-name">Blue</div>
                </div>
                <div class="theme-option" id="themeRed" onclick="selectTheme('red')">
                    <div class="theme-circle red"></div>
                    <div class="theme-name">Red</div>
                </div>
                <div class="theme-option" id="themeGreen" onclick="selectTheme('green')">
                    <div class="theme-circle green"></div>
                    <div class="theme-name">Green</div>
                </div>
            </div>
            <button class="theme-close-button" onclick="closeThemeSelector()">Apply & Close</button>
        </div>
    </div>

    <script>
        let selectedIndex = 0;
        let scrollOffset = 0;
        let currentMenu = 'main';
        let menuHistory = [];
        let searchActive = false;
        let currentTheme = 'blue';
        const themes = ['blue', 'red', 'green'];
        let currentThemeIndex = 0;
        
        // Menu data structure with proper page numbers and outlined emojis
        const menuData = {
            main: {
                title: 'Main Menu',
                pageNumber: 1,
                items: [
                    { text: 'Player', id: 'player', type: 'submenu', arrow: '¬ª' },
                    { text: 'Server', id: 'server', type: 'submenu', arrow: '¬ª' },
                    { text: 'Weapon', id: 'weapon', type: 'submenu', arrow: '¬ª' },
                    { text: 'Combat', id: 'combat', type: 'submenu', arrow: '¬ª' },
                    { text: 'Vehicle', id: 'vehicle', type: 'submenu', arrow: '¬ª' },
                    { text: 'Visual', id: 'visual', type: 'submenu', arrow: '¬ª' },
                    { text: 'Miscellaneous', id: 'misc', type: 'submenu', arrow: '¬ª' },
                    { text: 'Settings', id: 'settings', type: 'submenu', arrow: '¬ª' },
                    { text: 'Search', id: 'search', type: 'action', arrow: 'üîçÔ∏é' }
                ]
            },
            player: {
                title: 'Player Options',
                pageNumber: 2,
                items: [
                    { text: 'Set Health', id: 'sethealth', type: 'action', arrow: '¬ª' },
                    { text: 'Set Armor', id: 'setarmor', type: 'action', arrow: '¬ª' },
                    { text: 'Invisible', id: 'invisible', type: 'toggle', state: false },
                    { text: 'Never Wanted', id: 'neverwanted', type: 'toggle', state: false },
                    { text: 'Super Speed', id: 'superspeed', type: 'toggle', state: false },
                    { text: 'Teleport to Waypoint', id: 'tpwaypoint', type: 'action', arrow: '‚Üí' },
                    { text: 'Noclip Mode', id: 'noclip', type: 'toggle', state: false },
                    { text: 'Infinite Stamina', id: 'infinitestamina', type: 'toggle', state: false },
                    { text: 'Fast Swim', id: 'fastswim', type: 'toggle', state: false },
                    { text: 'Ragdoll Disabled', id: 'noragdoll', type: 'toggle', state: false }
                ]
            },
            server: {
                title: 'Server Options',
                pageNumber: 3,
                items: [
                    { text: 'Player List', id: 'playerlist', type: 'submenu', arrow: '¬ª' },
                    { text: 'Kick Player', id: 'kickplayer', type: 'action', arrow: '‚ò£Ô∏é' },
                    { text: 'Ban Player', id: 'banplayer', type: 'action', arrow: '‚ò£Ô∏é' },
                    { text: 'Spectate Player', id: 'spectate', type: 'toggle', state: false }
                ]
            },
            playerlist: {
                title: 'Players Online',
                pageNumber: 10,
                items: [
                    { text: 'CRQOLQVRQO', id: 'player1', type: 'player', arrow: 'üë§', data: { distance: '126.0m', serverId: '302902', health: '200 ü©∏', armor: '0', weapon: 'Unarmed', vehicle: 'Outside', alive: 'Alive', speed: '0km/h', friend: 'No' }},
                    { text: 'PlayerTwo', id: 'player2', type: 'player', arrow: 'üë§', data: { distance: '45.2m', serverId: '123456', health: '150 ü©∏', armor: '50', weapon: 'Pistol', vehicle: 'Adder', alive: 'Alive', speed: '85km/h', friend: 'Yes' }},
                    { text: 'GamerXYZ', id: 'player3', type: 'player', arrow: 'üë§', data: { distance: '203.7m', serverId: '789012', health: '0 ü©∏', armor: '0', weapon: 'None', vehicle: 'Outside', alive: 'Dead', speed: '0km/h', friend: 'No' }},
                    { text: 'ProPlayer', id: 'player4', type: 'player', arrow: 'üë§', data: { distance: '89.1m', serverId: '456789', health: '180 ü©∏', armor: '75', weapon: 'Assault Rifle', vehicle: 'Zentorno', alive: 'Alive', speed: '120km/h', friend: 'No' }}
                ]
            },
            weapon: {
                title: 'Weapon Options',
                pageNumber: 4,
                items: [
                    { text: 'Give All Weapons', id: 'giveallweapons', type: 'action', arrow: '‚ò£Ô∏é' },
                    { text: 'Remove All Weapons', id: 'removeallweapons', type: 'action', arrow: '‚ò£Ô∏é' },
                    { text: 'Pistol', id: 'givepistol', type: 'action', arrow: '+' },
                    { text: 'Assault Rifle', id: 'giveassaultrifle', type: 'action', arrow: '+' },
                    { text: 'Sniper Rifle', id: 'givesniper', type: 'action', arrow: '+' },
                    { text: 'RPG', id: 'giverpg', type: 'action', arrow: '+' }
                ]
            },
            combat: {
                title: 'Combat Options',
                pageNumber: 5,
                items: [
                    { text: 'God Mode', id: 'godmode', type: 'toggle', state: false },
                    { text: 'Infinite Ammo', id: 'infiniteammo', type: 'toggle', state: false },
                    { text: 'No Reload', id: 'noreload', type: 'toggle', state: true },
                    { text: 'Rapid Fire', id: 'rapidfire', type: 'toggle', state: false },
                    { text: 'Super Jump', id: 'superjump', type: 'toggle', state: false },
                    { text: 'Fast Run', id: 'fastrun', type: 'toggle', state: false },
                    { text: 'Explosive Bullets', id: 'explosivebullets', type: 'toggle', state: false },
                    { text: 'Kill All NPCs', id: 'killallnpcs', type: 'action', arrow: '‚ò†Ô∏éÔ∏é' }
                ]
            },
            vehicle: {
                title: 'Vehicle Options',
                pageNumber: 6,
                items: [
                    { text: 'Spawn Adder', id: 'spawnadder', type: 'action', arrow: 'üèéÔ∏è' },
                    { text: 'Spawn Zentorno', id: 'spawnzentorno', type: 'action', arrow: 'üèéÔ∏è' },
                    { text: 'Fix Vehicle', id: 'fixvehicle', type: 'action', arrow: 'üîß' },
                    { text: 'Vehicle God Mode', id: 'vehiclegodmode', type: 'toggle', state: false },
                    { text: 'Infinite Fuel', id: 'infinitefuel', type: 'toggle', state: false }
                ]
            },
            visual: {
                title: 'Visual Options',
                pageNumber: 7,
                items: [
                    { text: 'Night Vision', id: 'nightvision', type: 'toggle', state: false },
                    { text: 'Thermal Vision', id: 'thermalvision', type: 'toggle', state: false },
                    { text: 'No HUD', id: 'nohud', type: 'toggle', state: false }
                ]
            },
            misc: {
                title: 'Miscellaneous',
                pageNumber: 8,
                items: [
                    { text: 'Freeze Time', id: 'freezetime', type: 'toggle', state: false },
                    { text: 'Change Weather', id: 'changeweather', type: 'action', arrow: '‚òÅÔ∏é' }
                ]
            },
            settings: {
                title: 'Settings',
                pageNumber: 9,
                items: [
                    { text: 'Save Config', id: 'saveconfig', type: 'action', arrow: 'üóÅ' },
                    { text: 'Load Config', id: 'loadconfig', type: 'action', arrow: 'üóÅ' },
                    { text: 'Theme Color', id: 'themecolor', type: 'action', arrow: '‚úé' }
                ]
            }
        };

        // Search functionality
        function getAllSearchableItems() {
            const searchableItems = [];
            
            function addItems(menuId, menuName, items) {
                items.forEach(item => {
                    if (item.type !== 'submenu' || !menuData[item.id]) {
                        searchableItems.push({
                            text: item.text,
                            id: item.id,
                            type: item.type,
                            menuId: menuId,
                            menuName: menuName,
                            path: menuId === 'main' ? item.text : `${menuName} > ${item.text}`
                        });
                    }
                });
            }
            
            Object.keys(menuData).forEach(menuId => {
                const menu = menuData[menuId];
                addItems(menuId, menu.title, menu.items);
            });
            
            return searchableItems;
        }

        function performSearch(query) {
            if (!query.trim()) {
                document.getElementById('searchResults').innerHTML = '';
                return;
            }

            const searchableItems = getAllSearchableItems();
            const results = searchableItems.filter(item => 
                item.text.toLowerCase().includes(query.toLowerCase())
            ).slice(0, 10);

            const searchResults = document.getElementById('searchResults');
            if (results.length === 0) {
                searchResults.innerHTML = '<div class="search-result-item">No results found</div>';
                return;
            }

            searchResults.innerHTML = results.map(result => `
                <div class="search-result-item" onclick="navigateToSearchResult('${result.menuId}', '${result.id}')">
                    <div>${result.text}</div>
                    <div class="search-result-path">${result.path}</div>
                </div>
            `).join('');
        }

        function navigateToSearchResult(menuId, itemId) {
            hideSearch();
            
            // Navigate to the menu containing the item
            if (menuId !== currentMenu) {
                menuHistory = [];
                if (menuId !== 'main') {
                    menuHistory.push('main');
                }
                currentMenu = menuId;
                renderMenu(menuId);
            }

            // Find and select the item
            const menu = menuData[currentMenu];
            const itemIndex = menu.items.findIndex(item => item.id === itemId);
            if (itemIndex !== -1) {
                selectedIndex = itemIndex;
                updateSelection();
                updatePageIndicator();
                showNotification(`Found: ${menu.items[itemIndex].text}`);
            }
        }

        function showSearch() {
            document.getElementById('searchContainer').classList.add('visible');
            document.getElementById('searchInput').focus();
            searchActive = true;
        }

        function hideSearch() {
            document.getElementById('searchContainer').classList.remove('visible');
            document.getElementById('searchInput').value = '';
            document.getElementById('searchResults').innerHTML = '';
            searchActive = false;
        }

        // Theme management
        function changeTheme(direction) {
            if (direction === 'left') {
                currentThemeIndex = (currentThemeIndex - 1 + themes.length) % themes.length;
            } else if (direction === 'right') {
                currentThemeIndex = (currentThemeIndex + 1) % themes.length;
            }
            
            const newTheme = themes[currentThemeIndex];
            selectTheme(newTheme);
        }

        function selectTheme(theme) {
            currentTheme = theme;
            currentThemeIndex = themes.indexOf(theme);
            
            // Remove all theme classes
            document.body.classList.remove('theme-red', 'theme-green');
            
            // Add selected theme class
            if (theme !== 'blue') {
                document.body.classList.add(`theme-${theme}`);
            }
            
            // Update active theme option
            document.querySelectorAll('.theme-option').forEach(option => {
                option.classList.remove('active');
            });
            document.getElementById(`theme${theme.charAt(0).toUpperCase() + theme.slice(1)}`).classList.add('active');
            
            showNotification(`Theme: ${theme.charAt(0).toUpperCase() + theme.slice(1)}`);
        }

        function showThemeSelector() {
            document.getElementById('themeModal').classList.add('visible');
        }

        function closeThemeSelector() {
            document.getElementById('themeModal').classList.remove('visible');
        }

        // Player info display
        function showPlayerInfo(playerData) {
            const panel = document.getElementById('playerInfoPanel');
            
            document.getElementById('playerInfoName').textContent = playerData.text;
            document.getElementById('playerDistance').textContent = playerData.data.distance;
            document.getElementById('playerServerId').textContent = playerData.data.serverId;
            document.getElementById('playerHealth').textContent = playerData.data.health;
            document.getElementById('playerArmor').textContent = playerData.data.armor;
            document.getElementById('playerWeapon').textContent = playerData.data.weapon;
            document.getElementById('playerVehicle').textContent = playerData.data.vehicle;
            document.getElementById('playerAlive').textContent = playerData.data.alive;
            document.getElementById('playerSpeed').textContent = playerData.data.speed;
            document.getElementById('playerFriend').textContent = playerData.data.friend;
            
            // Update status colors
            const aliveElement = document.getElementById('playerAlive');
            aliveElement.className = 'player-info-value';
            if (playerData.data.alive === 'Alive') {
                aliveElement.classList.add('online');
            } else {
                aliveElement.classList.add('offline');
            }
            
            panel.classList.add('visible');
        }

        function hidePlayerInfo() {
            document.getElementById('playerInfoPanel').classList.remove('visible');
        }

        // Update page indicator based on current selection
        function updatePageIndicator() {
            const menu = menuData[currentMenu];
            const totalItems = menu.items.length;
            const currentPosition = selectedIndex + 1;
            
            document.getElementById('pageIndicator').textContent = `${currentPosition} / ${totalItems}`;
        }
        
        function renderMenu(menuId) {
            const menu = menuData[menuId];
            const container = document.getElementById('menuItems');
            const backButton = document.getElementById('backButton');
            
            container.innerHTML = '';
            
            // Show/hide back button
            if (menuId !== 'main') {
                backButton.classList.add('visible');
            } else {
                backButton.classList.remove('visible');
            }
            
            // Render menu items
            menu.items.forEach((item, index) => {
                const menuItem = document.createElement('div');
                menuItem.className = 'menu-item';
                if (index === selectedIndex) menuItem.classList.add('selected');
                
                if (item.type === 'toggle') {
                    menuItem.classList.add('toggle');
                    menuItem.innerHTML = `
                        <span class="menu-item-text">${item.text}</span>
                        <div class="toggle-switch ${item.state ? 'active' : ''}" onclick="toggleFeature('${item.id}', event)" data-toggle-id="${item.id}"></div>
                    `;
                } else {
                    menuItem.innerHTML = `
                        <span class="menu-item-text">${item.text}</span>
                        <span class="menu-item-arrow">${item.arrow}</span>
                    `;
                }
                
                // Add hover event for player items
                if (item.type === 'player') {
                    menuItem.addEventListener('mouseenter', () => {
                        showPlayerInfo(item);
                    });
                    menuItem.addEventListener('mouseleave', () => {
                        hidePlayerInfo();
                    });
                }
                
                menuItem.onclick = () => selectItem(item.id, item.type, index);
                container.appendChild(menuItem);
            });
            
            // Reset scroll and selection
            selectedIndex = 0;
            scrollOffset = 0;
            updateScroll();
            updateSelection();
            updateScrollbarVisibility();
            updatePageIndicator();
        }
        
        function updateScrollbarVisibility() {
            const menuItems = document.querySelectorAll('.menu-item');
            const scrollbarContainer = document.querySelector('.scrollbar-container');
            const visibleItems = 8;
            const itemHeight = 37;
            
            // Calculate actual height needed based on number of items
            const actualItemCount = menuItems.length;
            const maxDisplayItems = Math.min(actualItemCount, visibleItems);
            const containerHeight = maxDisplayItems * itemHeight;
            
            // Update scrollbar container height
            scrollbarContainer.style.height = containerHeight + 'px';
            
            // Update menu body height
            document.querySelector('.menu-body').style.height = containerHeight + 'px';
            
            // Always show scrollbar as requested, but resize it properly
            scrollbarContainer.classList.add('visible');
        }
        
        function selectItem(id, type, index) {
            selectedIndex = index;
            updateSelection();
            updatePageIndicator();
            
            if (type === 'submenu' && menuData[id]) {
                menuHistory.push(currentMenu);
                currentMenu = id;
                renderMenu(id);
            } else if (type === 'action') {
                if (id === 'search') {
                    showSearch();
                    return;
                } else if (id === 'themecolor') {
                    showThemeSelector();
                    return;
                }
                console.log(`Action triggered: ${id}`);
                showNotification(`${menuData[currentMenu].items[index].text}`);
                // In FiveM: TriggerEvent('menu:action', id)
            } else if (type === 'toggle') {
                // Allow Enter key to toggle switches
                const menu = menuData[currentMenu];
                const item = menu.items[index];
                item.state = !item.state;
                
                // Find the correct toggle switch using data attribute
                const toggleSwitches = document.querySelectorAll('.toggle-switch');
                let correctToggle = null;
                
                toggleSwitches.forEach(toggle => {
                    if (toggle.getAttribute('data-toggle-id') === item.id) {
                        correctToggle = toggle;
                    }
                });
                
                if (correctToggle) {
                    correctToggle.classList.toggle('active', item.state);
                    if (item.state) {
                        correctToggle.style.boxShadow = '0 0 10px rgba(59, 130, 246, 0.5)';
                    } else {
                        correctToggle.style.boxShadow = 'none';
                    }
                }
                
                showNotification(`${item.text} ${item.state ? 'Enabled' : 'Disabled'}`);
                console.log(`Toggle ${id}: ${item.state ? 'ON' : 'OFF'}`);
            } else if (type === 'player') {
                // Player selection action
                showNotification(`Selected: ${menuData[currentMenu].items[index].text}`);
                console.log(`Player selected: ${id}`);
            }
        }
        
        function showNotification(message) {
            // Remove existing notification
            const existing = document.querySelector('.notification');
            if (existing) {
                existing.remove();
            }
            
            // Create new notification
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.textContent = message;
            document.body.appendChild(notification);
            
            // Show notification with enhanced animation
            setTimeout(() => notification.classList.add('show'), 10);
            
            // Hide after 2.5 seconds
            setTimeout(() => {
                notification.classList.add('hide');
                setTimeout(() => notification.remove(), 500);
            }, 2500);
        }
        
        function toggleFeature(id, event) {
            event.stopPropagation();
            const menu = menuData[currentMenu];
            const item = menu.items.find(i => i.id === id);
            if (item) {
                item.state = !item.state;
                const toggleSwitch = event.target;
                
                // Add smooth animation
                toggleSwitch.style.transform = 'scale(0.95)';
                setTimeout(() => {
                    toggleSwitch.style.transform = 'scale(1)';
                }, 100);
                
                toggleSwitch.classList.toggle('active', item.state);
                
                // Visual feedback
                if (item.state) {
                    toggleSwitch.style.boxShadow = '0 0 10px var(--primary-glow)';
                } else {
                    toggleSwitch.style.boxShadow = 'none';
                }
                
                console.log(`Toggle ${id}: ${item.state ? 'ON' : 'OFF'}`);
                // In FiveM: TriggerEvent('menu:toggle', id, item.state)
                
                // Add success feedback
                showNotification(`${item.text} ${item.state ? 'Enabled' : 'Disabled'}`);
            }
        }
        
        function goBack() {
            if (menuHistory.length > 0) {
                currentMenu = menuHistory.pop();
                renderMenu(currentMenu);
            }
        }
        
        function updateSelection() {
            const menuItems = document.querySelectorAll('.menu-item');
            menuItems.forEach((item, index) => {
                item.classList.toggle('selected', index === selectedIndex);
            });
            
            // Auto scroll to keep selected item visible
            const visibleItems = 8;
            const maxScroll = Math.max(0, menuItems.length - visibleItems);
            
            if (selectedIndex < scrollOffset) {
                scrollOffset = selectedIndex;
            } else if (selectedIndex >= scrollOffset + visibleItems) {
                scrollOffset = selectedIndex - visibleItems + 1;
            }
            
            updateScroll();
        }
        
        function updateScroll() {
            const menuItems = document.querySelectorAll('.menu-item');
            const menuItemsContainer = document.getElementById('menuItems');
            const scrollThumb = document.getElementById('scrollThumb');
            const scrollbarContainer = document.querySelector('.scrollbar-container');
            
            const itemHeight = 37; // Updated to account for margin
            const visibleItems = 8;
            const actualItemCount = menuItems.length;
            const maxDisplayItems = Math.min(actualItemCount, visibleItems);
            const containerHeight = maxDisplayItems * itemHeight;
            const maxScroll = Math.max(0, actualItemCount - visibleItems);
            
            scrollOffset = Math.max(0, Math.min(maxScroll, scrollOffset));
            const translateY = -scrollOffset * itemHeight;
            menuItemsContainer.style.transform = `translateY(${translateY}px)`;
            
            // Update scrollbar thumb
            if (maxScroll > 0) {
                const thumbHeight = Math.max(20, (visibleItems / actualItemCount) * containerHeight);
                const thumbPosition = (scrollOffset / maxScroll) * (containerHeight - thumbHeight);
                scrollThumb.style.height = thumbHeight + 'px';
                scrollThumb.style.top = thumbPosition + 'px';
            } else {
                // If no scrolling needed, make thumb fill entire scrollbar
                scrollThumb.style.height = containerHeight + 'px';
                scrollThumb.style.top = '0px';
            }
        }
        
        // Scrollbar dragging
        let isDragging = false;
        let dragStartY = 0;
        let initialThumbTop = 0;
        
        document.getElementById('scrollThumb').addEventListener('mousedown', (e) => {
            isDragging = true;
            dragStartY = e.clientY;
            initialThumbTop = parseFloat(document.getElementById('scrollThumb').style.top) || 0;
            document.addEventListener('mousemove', handleDrag);
            document.addEventListener('mouseup', stopDrag);
            e.preventDefault();
        });
        
        function handleDrag(e) {
            if (!isDragging) return;
            
            const menuItems = document.querySelectorAll('.menu-item');
            const visibleItems = 8;
            const actualItemCount = menuItems.length;
            const maxDisplayItems = Math.min(actualItemCount, visibleItems);
            const containerHeight = maxDisplayItems * 37;
            const maxScroll = Math.max(0, actualItemCount - visibleItems);
            const thumbHeight = Math.max(20, (visibleItems / actualItemCount) * containerHeight);
            
            if (maxScroll === 0) return; // No scrolling needed
            
            const deltaY = e.clientY - dragStartY;
            const newTop = initialThumbTop + deltaY;
            const maxTop = containerHeight - thumbHeight;
            const clampedTop = Math.max(0, Math.min(maxTop, newTop));
            
            const scrollThumb = document.getElementById('scrollThumb');
            scrollThumb.style.transition = 'none';
            scrollThumb.style.top = clampedTop + 'px';
            
            scrollOffset = Math.round((clampedTop / maxTop) * maxScroll);
            updateScroll();
        }
        
        function stopDrag() {
            isDragging = false;
            const scrollThumb = document.getElementById('scrollThumb');
            scrollThumb.style.transition = 'all 0.3s cubic-bezier(0.4, 0, 0.2, 1)';
            document.removeEventListener('mousemove', handleDrag);
            document.removeEventListener('mouseup', stopDrag);
        }
        
        // Search input event listener
        document.getElementById('searchInput').addEventListener('input', (e) => {
            performSearch(e.target.value);
        });

        // Close search when clicking outside
        document.addEventListener('click', (e) => {
            if (searchActive && !document.getElementById('searchContainer').contains(e.target)) {
                hideSearch();
            }
        });

        // Close theme modal when clicking outside
        document.addEventListener('click', (e) => {
            const themeModal = document.getElementById('themeModal');
            if (themeModal.classList.contains('visible') && e.target === themeModal) {
                closeThemeSelector();
            }
        });
        
        // Keyboard navigation with smooth delay
        let navigationTimeout;
        let isNavigating = false;
        
        document.addEventListener('keydown', (e) => {
            // Handle search input
            if (searchActive) {
                if (e.key === 'Escape') {
                    hideSearch();
                    e.preventDefault();
                }
                return; // Let search input handle other keys
            }

            const menuItems = document.querySelectorAll('.menu-item');
            
            // Prevent rapid navigation
            if (isNavigating && (e.key === 'ArrowUp' || e.key === 'ArrowDown')) return;
            
            // Clear existing timeout
            if (navigationTimeout) {
                clearTimeout(navigationTimeout);
            }
            
            switch(e.key) {
                case 'ArrowUp':
                    isNavigating = true;
                    selectedIndex = Math.max(0, selectedIndex - 1);
                    
                    // Add smooth delay effect matching scrollbar
                    navigationTimeout = setTimeout(() => {
                        updateSelection();
                        updatePageIndicator();
                        isNavigating = false;
                    }, 80);
                    e.preventDefault();
                    break;
                case 'ArrowDown':
                    isNavigating = true;
                    selectedIndex = Math.min(menuItems.length - 1, selectedIndex + 1);
                    
                    // Add smooth delay effect matching scrollbar
                    navigationTimeout = setTimeout(() => {
                        updateSelection();
                        updatePageIndicator();
                        isNavigating = false;
                    }, 80);
                    e.preventDefault();
                    break;
                case 'ArrowLeft':
                    changeTheme('left');
                    e.preventDefault();
                    break;
                case 'ArrowRight':
                    changeTheme('right');
                    e.preventDefault();
                    break;
                case 'Enter':
                    if (menuItems[selectedIndex]) {
                        menuItems[selectedIndex].click();
                    }
                    e.preventDefault();
                    break;
                case 'Escape':
                case 'Backspace':
                    if (currentMenu !== 'main') {
                        goBack();
                    } else {
                        console.log('Menu closed');
                    }
                    e.preventDefault();
                    break;
            }
        });
        
        // Mouse wheel scrolling
        document.querySelector('.menu-body').addEventListener('wheel', (e) => {
            const menuItems = document.querySelectorAll('.menu-item');
            const visibleItems = 8;
            const maxScroll = Math.max(0, menuItems.length - visibleItems);
            
            if (maxScroll > 0) {
                const direction = e.deltaY > 0 ? 1 : -1;
                scrollOffset = Math.max(0, Math.min(maxScroll, scrollOffset + direction));
                updateScroll();
            }
            e.preventDefault();
        });
        
        // Add mouse hover event listener to update page indicator
        document.addEventListener('DOMContentLoaded', () => {
            document.addEventListener('mouseover', (e) => {
                if (e.target.closest('.menu-item')) {
                    const menuItem = e.target.closest('.menu-item');
                    const menuItems = document.querySelectorAll('.menu-item');
                    const hoveredIndex = Array.from(menuItems).indexOf(menuItem);
                    
                    if (hoveredIndex !== -1) {
                        const menu = menuData[currentMenu];
                        const totalItems = menu.items.length;
                        const currentPosition = hoveredIndex + 1;
                        
                        document.getElementById('pageIndicator').textContent = `${currentPosition} / ${totalItems}`;
                    }
                }
            });
            
            // Reset page indicator when mouse leaves menu area
            document.querySelector('.menu-container').addEventListener('mouseleave', () => {
                updatePageIndicator();
            });
        });
        
        // Initialize
        renderMenu('main');
    </script>
</body>
</html>